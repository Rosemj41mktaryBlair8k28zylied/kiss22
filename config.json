Refactor codebase with Z [akyXIO] line 3.1
Add test case for W [OTkUYa] line 4.1
